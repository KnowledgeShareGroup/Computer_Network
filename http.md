### Http

#### 1. Http报文结构

组成结构：`请求行+ 请求头 + 空行 + body`或者`响应⾏、响应头、空⾏、响应体`

<img src="/Users/Mr.Meow/Library/Application Support/typora-user-images/image-20220327001144979.png" alt="image-20220327001144979" style="zoom:50%;" />

举个🌰请求报文和响应报文：

<img src="/Users/Mr.Meow/Library/Application Support/typora-user-images/image-20220327001356674.png" alt="image-20220327001356674" style="zoom:50%;" />

<img src="/Users/Mr.Meow/Library/Application Support/typora-user-images/image-20220327001833711.png" alt="image-20220327001833711" style="zoom:30%;" />

##### 起始行

对于请求报文，请求行类似于`GET /home HTTP/1.1`，分别为**方法 路径 协议版本**

对于相应报文，起始行类似于`HTTP/1.1 200 OK`，分别为**协议版本 状态码 原因**

在起始行中，每个部分之间都用空格隔开，最后接上转行

##### header

请求头由键值对组成，每⾏⼀对，键值之间⽤英⽂冒号`:`进行分隔。例如：

```
Content-Type: application/json
Host: www.abc.com
```

##### 空行

空行用来区分header和body，如果说在header中故意加一个空行，那么空行后面的内容都会被视为body

##### 请求体

请求体中放置 POST、PUT、PATCH 等请求方法所需要携带的数据。

#### 2. HTTP的请求方法

|  方法   | 功能                                                         |
| :-----: | ------------------------------------------------------------ |
|   GET   | 通常⽤于请求服务器发送/请求某些资源（不要被字面意思欺骗了，可获取也可发送） |
|  POST   | 发送数据给服务器（可发可获取）                               |
|  HEAD   | 请求资源的头部信息, 并且这些头部与 HTTP GET ⽅法请求时返回的⼀致。<br />该请求⽅法的⼀个使⽤场景是在下载⼀个⼤⽂件前先获取其⼤⼩再决定是否要下载, 以此可以节约带宽资源 |
|   PUT   | ⽤于全量修改⽬标资源 (看接口, 也可以用于添加)                |
| DELETE  | ⽤于删除指定的资源                                           |
| OPTIONS | ⽤于获取⽬的资源所⽀持的通信选项 (跨域请求前, 预检请求, 判断目标是否安全) |
|  TRACE  | 追踪请求-响应的传输路径 用于诊断和判断                       |
| CONNECT | HTTP/1.1协议中预留给能够将连接改为管道⽅式的代理服务器<br />(把服务器作为跳板，让服务器代替用户去访问其它网页, 之后把数据原原本本的返回给用户) |
|  PATCH  | ⽤于对资源进⾏部分修改                                       |

#### 3. GET 和 POST的区别

|                  | GET方法                                                      | POST方法                                                     |
| ---------------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| **数据传输⽅式** | 通过URL传输数据 (地址栏拼接参数)                             | 通过请求体传输                                               |
| **数据安全**     | 数据暴露在URL中，可通过浏览历史记录、缓存等很容易查到数据信息 <br />get请求会被浏览器主动缓存下来，留下历史记录，而post不会 | 数据因为在请求主体内，<br />所以有⼀定的安全性保证           |
| **数据类型**     | 只允许 ASCII 字符                                            | ⽆限制                                                       |
| **GET⽆害**      | 刷新、后退等浏览器操作是⽆害的                               | 可能会引起重复提交表单                                       |
| **功能特性**     | 安全且幂等（这⾥的安全是指只读特性，就是使⽤这个⽅法不会引起服务器状态变化。<br />**幂等的概念是指同⼀个请求⽅法执⾏多次和仅执⾏⼀次的效果完全相同）** | ⾮安全(会引起服务器端的变化)、**⾮幂等**                     |
| **TCP的角度**    | GET会把请求报文一次性发出去                                  | 把数据分两个 TCP 数据包，先发 header 部分，<br />如果服务器响应 100(continue)， 然后发 body 部分。<br />(但是火狐浏览器的 POST 请求只发一个 TCP 包) |

#### 4. HTTP状态码

RFC 规定 HTTP 的状态码为三位数，被分为五类: 

```
1xx: 表示目前是协议处理的中间状态，还需要后续操作。 
2xx: 表示成功状态。 
3xx: 重定向状态，资源位置发生变动，需要重新请求。 
4xx: 请求报文有误。 
5xx: 服务器端发生错误
```

**1xx :**

| 状态码 | 原因短语            | 说明                                                         |
| ------ | ------------------- | ------------------------------------------------------------ |
| 101    | Switching Protocols | 在 HTTP 升级为 WebSocket 的时候，如果服务器同意变更，就会发送状态 码 101。 |

**成功（2XX）**

| 状态码 | 原因短语        | 说明                                                         |
| ------ | --------------- | ------------------------------------------------------------ |
| 200    | OK              | 表示从客户端发来的请求在服务器端被正确处理，通常在响应体中放有数据。 |
| 201    | Created         | 请求已经被实现，⽽且有⼀个新的资源已经依据请求的需要⽽建⽴<br />通常是在POST请求，或是某些PUT请求之后创建了内容, 进行的返回的响应 |
| 202    | Accepted        | 请求服务器已接受，但是尚未处理，不保证完成请求<br />适合异步任务或者说需要处理时间比较长的请求，避免HTTP连接一直占用 |
| 204    | No content      | 表示请求成功，但响应报⽂不含实体的主体部分                   |
| 206    | Partial Content | 进⾏的是范围请求, 表示服务器已经成功处理了部分 GET 请求<br />响应头中会包含获取的内容范围 (常用于分段下载) |

**重定向（3XX）**

| 状态码  | 原因短语           | 说明                                                         |
| ------- | ------------------ | ------------------------------------------------------------ |
| 301     | Moved Permanently  | 永久性重定向，表示资源已被分配了新的 URL<br />比如，我们访问 **http**://www.baidu.com 会跳转到 **https**://www.baidu.com |
| 302     | Found              | 临时性重定向，表示资源临时被分配了新的 URL, 支持搜索引擎优化<br />首页, 个人中心, 遇到了需要登录才能操作的内容, 重定向 到 登录页 |
| 303     | See Other          | 对于POST请求，它表示请求已经被处理，客户端可以接着使用GET方法去请求Location里的URI。 |
| **304** | **Not Modified**   | **自从上次请求后，请求的网页内容未修改过。<br />服务器返回此响应时，不会返回网页内容。(协商缓存)** |
| 307     | Temporary Redirect | 对于POST请求，表示请求还没有被处理，客户端应该向Location里的URI重新发起POST请求。<br />不对请求做额外处理, 正常发送请求, 请求location中的url地址 |

**客户端错误（4XX）**

| 状态码  | 原因短语        | 说明                                        |
| ------- | --------------- | ------------------------------------------- |
| **400** | **Bad Request** | **请求报⽂存在语法错误(（传参格式不正确）** |
| 401     | UnAuthorized    | 权限认证未通过(没有权限)                    |
| 403     | Forbidden       | 表示对请求资源的访问被服务器拒绝            |
| 404     | Not Found       | 表示在服务器上没有找到请求的资源            |
| 408     | Request Timeout | 客户端请求超时                              |
| 409     | Confict         | 请求的资源可能引起冲突                      |

